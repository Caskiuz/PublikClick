<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Panel Admin - PubliClick</title>\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\" rel=\"stylesheet\">\n</head>\n<body class=\"bg-gray-100\">\n    <div class=\"flex h-screen\">\n        <!-- Admin Sidebar -->\n        <div class=\"bg-red-800 text-white w-64 min-h-screen p-4\">\n            <div class=\"mb-8\">\n                <h1 class=\"text-xl font-bold\">Admin Panel</h1>\n                <p class=\"text-red-200 text-sm\">PubliClick System</p>\n            </div>\n            \n            <nav class=\"space-y-2\">\n                <a href=\"/admin\" class=\"flex items-center space-x-3 text-white bg-red-600 p-3 rounded-lg\">\n                    <i class=\"fas fa-tachometer-alt\"></i>\n                    <span>Dashboard</span>\n                </a>\n                <a href=\"/admin/users\" class=\"flex items-center space-x-3 text-red-200 hover:text-white hover:bg-red-700 p-3 rounded-lg\">\n                    <i class=\"fas fa-users\"></i>\n                    <span>Usuarios</span>\n                </a>\n                <a href=\"/admin/withdrawals\" class=\"flex items-center space-x-3 text-red-200 hover:text-white hover:bg-red-700 p-3 rounded-lg\">\n                    <i class=\"fas fa-money-bill-wave\"></i>\n                    <span>Retiros</span>\n                </a>\n                <a href=\"/admin/reports\" class=\"flex items-center space-x-3 text-red-200 hover:text-white hover:bg-red-700 p-3 rounded-lg\">\n                    <i class=\"fas fa-chart-bar\"></i>\n                    <span>Reportes</span>\n                </a>\n                <a href=\"{{ route('dashboard') }}\" class=\"flex items-center space-x-3 text-red-200 hover:text-white hover:bg-red-700 p-3 rounded-lg\">\n                    <i class=\"fas fa-arrow-left\"></i>\n                    <span>Volver al Sistema</span>\n                </a>\n            </nav>\n        </div>\n\n        <!-- Main Content -->\n        <div class=\"flex-1 flex flex-col overflow-hidden\">\n            <header class=\"bg-white shadow-sm border-b p-4\">\n                <h2 class=\"text-2xl font-semibold text-gray-800\">Dashboard Administrativo</h2>\n            </header>\n\n            <main class=\"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6\">\n                <!-- Stats Cards -->\n                <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <div class=\"flex items-center\">\n                            <div class=\"p-3 rounded-full bg-blue-100 text-blue-600\">\n                                <i class=\"fas fa-users text-xl\"></i>\n                            </div>\n                            <div class=\"ml-4\">\n                                <h3 class=\"text-lg font-semibold text-gray-700\">Total Usuarios</h3>\n                                <p class=\"text-2xl font-bold text-blue-600\">{{ number_format($stats['total_users']) }}</p>\n                                <p class=\"text-sm text-gray-500\">{{ number_format($stats['active_users']) }} activos</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <div class=\"flex items-center\">\n                            <div class=\"p-3 rounded-full bg-green-100 text-green-600\">\n                                <i class=\"fas fa-mouse-pointer text-xl\"></i>\n                            </div>\n                            <div class=\"ml-4\">\n                                <h3 class=\"text-lg font-semibold text-gray-700\">Clicks Hoy</h3>\n                                <p class=\"text-2xl font-bold text-green-600\">{{ number_format($stats['total_clicks_today']) }}</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <div class=\"flex items-center\">\n                            <div class=\"p-3 rounded-full bg-red-100 text-red-600\">\n                                <i class=\"fas fa-exclamation-triangle text-xl\"></i>\n                            </div>\n                            <div class=\"ml-4\">\n                                <h3 class=\"text-lg font-semibold text-gray-700\">Retiros Pendientes</h3>\n                                <p class=\"text-2xl font-bold text-red-600\">{{ number_format($stats['pending_withdrawals']) }}</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Financial Stats -->\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <h3 class=\"text-xl font-semibold mb-4\">Ingresos Totales</h3>\n                        <p class=\"text-3xl font-bold text-green-600\">${{ number_format(abs($stats['total_revenue']), 2) }}</p>\n                        <p class=\"text-gray-500\">Por venta de paquetes</p>\n                    </div>\n                    \n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <h3 class=\"text-xl font-semibold mb-4\">Total Pagado</h3>\n                        <p class=\"text-3xl font-bold text-red-600\">${{ number_format(abs($stats['total_earnings_paid']), 2) }}</p>\n                        <p class=\"text-gray-500\">En retiros completados</p>\n                    </div>\n                </div>\n\n                <!-- Recent Activity -->\n                <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                    <!-- Recent Users -->\n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <h3 class=\"text-xl font-semibold mb-4\">Usuarios Recientes</h3>\n                        <div class=\"space-y-3\">\n                            @foreach($recent_users as $user)\n                            <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded\">\n                                <div>\n                                    <p class=\"font-semibold\">{{ $user->name }}</p>\n                                    <p class=\"text-sm text-gray-500\">{{ $user->email }}</p>\n                                </div>\n                                <div class=\"text-right\">\n                                    <p class=\"text-sm font-semibold\">{{ $user->currentPackage->name ?? 'Sin paquete' }}</p>\n                                    <p class=\"text-xs text-gray-500\">{{ $user->created_at->diffForHumans() }}</p>\n                                </div>\n                            </div>\n                            @endforeach\n                        </div>\n                    </div>\n\n                    <!-- Pending Withdrawals -->\n                    <div class=\"bg-white rounded-lg shadow p-6\">\n                        <h3 class=\"text-xl font-semibold mb-4\">Retiros Pendientes</h3>\n                        <div class=\"space-y-3\">\n                            @foreach($pending_withdrawals as $withdrawal)\n                            <div class=\"flex items-center justify-between p-3 bg-yellow-50 rounded\">\n                                <div>\n                                    <p class=\"font-semibold\">{{ $withdrawal->user->name }}</p>\n                                    <p class=\"text-sm text-gray-500\">{{ $withdrawal->created_at->format('d/m/Y H:i') }}</p>\n                                </div>\n                                <div class=\"text-right\">\n                                    <p class=\"text-lg font-bold text-red-600\">${{ number_format(abs($withdrawal->amount), 2) }}</p>\n                                    <div class=\"space-x-2\">\n                                        <button onclick=\"approveWithdrawal({{ $withdrawal->id }})\" \n                                                class=\"text-xs bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600\">\n                                            Aprobar\n                                        </button>\n                                        <button onclick=\"rejectWithdrawal({{ $withdrawal->id }})\" \n                                                class=\"text-xs bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600\">\n                                            Rechazar\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n                            @endforeach\n                        </div>\n                    </div>\n                </div>\n            </main>\n        </div>\n    </div>\n\n    <script>\n        async function approveWithdrawal(id) {\n            if (!confirm('¿Aprobar este retiro?')) return;\n            \n            try {\n                const response = await fetch(`/admin/withdrawals/${id}/approve`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'X-CSRF-TOKEN': '{{ csrf_token() }}'\n                    }\n                });\n                \n                const result = await response.json();\n                alert(result.message);\n                \n                if (result.success) {\n                    location.reload();\n                }\n            } catch (error) {\n                alert('Error al procesar la solicitud');\n            }\n        }\n\n        async function rejectWithdrawal(id) {\n            if (!confirm('¿Rechazar este retiro? Los fondos serán devueltos al usuario.')) return;\n            \n            try {\n                const response = await fetch(`/admin/withdrawals/${id}/reject`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'X-CSRF-TOKEN': '{{ csrf_token() }}'\n                    }\n                });\n                \n                const result = await response.json();\n                alert(result.message);\n                \n                if (result.success) {\n                    location.reload();\n                }\n            } catch (error) {\n                alert('Error al procesar la solicitud');\n            }\n        }\n    </script>\n</body>\n</html>